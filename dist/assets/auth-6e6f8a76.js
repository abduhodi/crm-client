import{v as I,C as n}from"./index-c34ed4f6.js";import{a as r}from"./apiClient-172dff35.js";const l={login(s){const t="auth/login";return r.post(t,s)},logout(){const s="auth/logout";return r.post(s)},getProfileInfo(){const s="profile/info";return r.get(s)},profileUpdate(s){const t="profile/update";return r.put(t,s)},changePassword(s){const t="profile/change-password";return r.post(t,s)},uploadImage(s){const t="profile/upload-image";return r.post(t,s)}},k=I("auth",{state:()=>({user:null,loading:!1,error:null}),getters:{},actions:{async login(s){var t,a,e,i,u,c,g,h,p,d,f,m,y,w;try{this.loading=!0;const o=await l.login(s);this.user=JSON.parse(JSON.stringify(o)),localStorage.setItem("user",JSON.stringify(o==null?void 0:o.user)),(t=o==null?void 0:o.tokens)!=null&&t.access_token&&(localStorage.setItem("token",o.tokens.access_token),localStorage.setItem("role",(a=o==null?void 0:o.user)==null?void 0:a.role)),((i=(e=this.user)==null?void 0:e.user)==null?void 0:i.role)==="admin"?n.push({name:"students"}):((c=(u=this.user)==null?void 0:u.user)==null?void 0:c.role)==="student"?n.push({name:"student"}):((h=(g=this.user)==null?void 0:g.user)==null?void 0:h.role)==="director"?n.push({name:"director"}):((d=(p=this.user)==null?void 0:p.user)==null?void 0:d.role)==="teacher"&&n.push({name:"teacher"})}catch(o){this.error=(m=(f=o==null?void 0:o.response)==null?void 0:f.data)!=null&&m.message?(w=(y=o==null?void 0:o.response)==null?void 0:y.data)==null?void 0:w.message:o.message,console.log(o)}finally{this.loading=!1}},async logout(){try{await l.logout()}catch(s){console.log(s)}},async getProfileInfo(){var s,t;try{this.loading=!0;const a=await l.getProfileInfo();this.user={...a}}catch(a){this.error=(t=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:t.message,console.log(a)}finally{this.loading=!1}},async profileUpdate(s){var t,a;try{this.loading=!0;const e=await l.profileUpdate(s);return this.user=e==null?void 0:e.updated,e==null?void 0:e.updated}catch(e){this.error=(a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message,console.log(e)}finally{this.loading=!1}},async changePassword(s){var t,a;try{this.loading=!0;const e=await l.changePassword(s);console.log(e)}catch(e){this.error=(a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message,console.log(e)}finally{this.loading=!1}},async uploadImage(s){var t,a;try{this.loading=!0;const e=await l.uploadImage(s);return console.log(e),e==null?void 0:e.image}catch(e){this.error=(a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message,console.log(e)}finally{this.loading=!1}}}});export{k as u};
