import{A as D}from"./app-modal-ef920211.js";import{_ as N,s as E,d as j,w as U}from"./VButton-d6e73414.js";import{_ as A}from"./VInput-1c3b4578.js";import{u as B}from"./student-f053e9b1.js";import{S as O,j as H}from"./mdi-32fed39f.js";import{r as u,c as F,k as R,l as T,a as I,o as p,b as v,f as t,w as i,d as l,u as _,t as h,g as V,F as z,m as G,h as J,i as q,q as K}from"./index-5fceaf5e.js";import{L as Q}from"./Loader-35472409.js";import{_ as W,a as X}from"./VAction-11eb2faf.js";import"./apiClient-4e000a57.js";const Y={class:"w-full flex justify-center items-center"},Z={class:"text-[24px] font-bold w-full text-center mb-[20px] text-color1"},ee={class:"flex justify-center items-center w-full gap-3"},te={class:"text-[24px] font-bold w-full text-center mb-[20px] text-color1"},ae={__name:"StudentModal",setup(P,{expose:$}){const a=B(),d=u(!1),o=u(!1),n=u(!1),f=u("Add New Student"),r=u(null),C=u("Are you sure to delete?"),x=F(()=>a.loading?"Loading":"Save");let s=R({first_name:"",last_name:"",phone:""});T(n,e=>{e||(s={first_name:"",last_name:"",phone:""},f.value="Add New Student")});const L=e=>{e._id&&(s={...e},f.value="Edit Student"),n.value=!0},y=e=>{r.value=e,o.value=!0},g=()=>{o.value=!1},w=()=>{n.value=!1},b=F(()=>({last_name:"required|min:3|max:30",first_name:"required|min:3|max:30",phone:"required|phone:19"})),k=async e=>{d.value=!0,s!=null&&s._id?await a.updateStudent({...e,phone:e.phone.split("").filter(c=>c==="+"||!isNaN(+c)).join("")},s==null?void 0:s._id)?(E("successfully updated "),n.value=!1,location.reload()):(console.log(a.error,"error"),j(a.error.message)):await a.addStudent({...e,phone:e.phone.split("").filter(c=>c==="+"||!isNaN(+c)).join("")})?(E("successfully added "),n.value=!1,location.reload()):j(a.error),d.value=!1},S=async()=>{d.value=!0;const e=await a.deleteStudent(r.value);d.value=!1,e?U("Deleted success"):j("Failed!"),o.value=!1,location.reload()};return $({openModal:L,closeModal:w,openDelModal:y}),(e,m)=>{const c=I("vee-form");return p(),v(z,null,[t(D,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=M=>o.value=M)},{default:i(()=>[t(c,null,{default:i(()=>[l("span",Y,[t(_(O),{type:"mdi",path:_(H),class:"w-20 h-20 text-red-700 mb-3"},null,8,["path"])]),l("h1",Z,h(C.value),1),l("div",ee,[t(N,{btn_type:"danger",isLoading:d.value,type:"button",class:"mt-5 text-[18px] px-8",onClick:S},{default:i(()=>[V(" Delete ")]),_:1},8,["isLoading"]),t(N,{btn_type:"primary",isLoading:!1,type:"button",class:"mt-5 px-8 text-[18px]",onClick:g},{default:i(()=>[V(" Cancel ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=M=>n.value=M)},{default:i(()=>[l("h1",te,h(f.value),1),t(c,{"validation-schema":b.value,"initial-values":_(s),onSubmit:k},{default:i(()=>[t(A,{type:"text",name:"first_name",label:"First Name",placeholder:"Enter your name"}),t(A,{type:"text",name:"last_name",label:"Last Name",placeholder:"Enter your surname"}),t(A,{type:"text",name:"phone",label:"Phone",placeholder:"(+998)-90-123-45-67",mask:"(+998)-##-###-##-##"}),t(N,{btn_type:"primary",isLoading:d.value,type:"submit",class:"mt-5 w-full text-[18px]"},{default:i(()=>[V(h(x.value),1)]),_:1},8,["isLoading"])]),_:1},8,["validation-schema","initial-values"])]),_:1},8,["modelValue"])],64)}}},se={class:"w-full pt-5"},le={class:"w-full"},oe={key:1},ne={class:"w-full flex justify-between items-center sm:pr-5 pr-1"},ie={class:"text-[#002842] text-[22px] font-semibold uppercase"},ue={class:"w-full overflow-auto mt-5"},de=l("span",{class:"w-full flex justify-center items-center"},[l("input",{type:"checkbox",class:"w-[18px] h-[18px]"})],-1),ce=["onClick"],re={class:"w-full flex justify-start items-center"},me={key:1,class:"w-full text-center text-[20px] text-color1 mt-10 font-medium"},pe={key:2,class:"w-full flex justify-end px-5 items-center mt-3"},ke={__name:"StudentPage",setup(P){const $=G(),a=B(),d=async()=>{r.value=await a.getStudents(o.value)},o=u({page:1,limit:10}),n=u(),f=u([{title:"checkbox",value:"check"},{title:"ID",value:"_id"},{title:"Full name",value:"full_name"},{title:"Phone number",value:"phone"},{title:"Status",value:"status"},{title:"Action",value:"action"}]),r=u(0);J(async()=>{r.value=await a.getStudents(o.value)});const C=x=>{$.push({path:`/students/${x}`})};return(x,s)=>{var y,g,w,b,k,S;const L=I("vue-awesome-paginate");return p(),v("div",se,[l("div",le,[t(ae,{ref_key:"student_modal",ref:n},null,512)]),_(a).loading?(p(),q(Q,{key:0})):(p(),v("div",oe,[l("div",ne,[l("h1",ie," Students ("+h(r.value)+") ",1),t(N,{type:"button",btn_type:"primary",isLoading:!1,onClick:(y=n.value)==null?void 0:y.openModal,class:"px-10"},{default:i(()=>[V("Add student")]),_:1},8,["onClick"])]),l("div",ue,[(w=(g=_(a))==null?void 0:g.students)!=null&&w.length?(p(),q(W,{key:0,header:f.value,data:(b=_(a))==null?void 0:b.students},{body_check:i(()=>[de]),body_full_name:i(({item:e})=>[l("span",{onClick:m=>C(e._id),class:"w-full"},h(`${e.first_name} ${e.last_name}`),9,ce)]),body_action:i(({item:e})=>[l("span",re,[t(X,{item:e,item_action:n.value},null,8,["item","item_action"])])]),_:1},8,["header","data"])):(p(),v("h1",me," No data ")),(S=(k=_(a))==null?void 0:k.students)!=null&&S.length?(p(),v("div",pe,[t(L,{"total-items":r.value,"items-per-page":o.value.limit,"max-pages-shown":2,modelValue:o.value.page,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value.page=e),"on-click":d},null,8,["total-items","items-per-page","modelValue"])])):K("",!0)])]))])}}};export{ke as default};
