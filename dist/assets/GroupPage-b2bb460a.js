import{r as s,c as W,l as pe,h as X,a as E,o as i,b as v,f as d,w as o,d as t,u as D,t as u,g as L,y as A,z as me,A as F,i as O,q,F as P,e as J,m as _e}from"./index-5fceaf5e.js";import{A as K}from"./app-modal-ef920211.js";import{_ as U,s as Q,d as R,w as ve}from"./VButton-d6e73414.js";import{u as Z}from"./group-26fdcc00.js";import{u as fe}from"./course-7aea3cf8.js";import{S as xe,j as ye}from"./mdi-32fed39f.js";import{h as ee}from"./moment-a9aaa855.js";import{L as be}from"./Loader-35472409.js";import{_ as he,a as ge}from"./VAction-11eb2faf.js";import"./apiClient-4e000a57.js";const we={class:"w-full flex justify-center items-center"},ke={class:"text-[24px] font-bold w-full text-center mb-[20px] text-color1"},Se={class:"flex justify-center items-center w-full gap-3"},Ve={class:"text-[16px] font-bold w-full text-center mb-[10px] text-color1"},De=t("label",{for:"name",class:"text-[14px] text-color1 font-medium mb-1 inline-block"},"Group name",-1),Ce={class:"flex justify-between items-center gap-3 mb-2"},$e=t("label",{for:"startDate",class:"text-[14px] text-color1 font-medium mb-1 inline-block w-full"},"Pick Group Start Date",-1),Ge=t("p",{class:"text-[14px] text-color1 font-medium mb-1 inline-block w-full"}," Select Group start and finish time ",-1),Me={class:"flex justify-between gap-3 mb-2"},je={class:"flex justify-between items-center gap-3 mb-2"},Ae=t("label",{for:"days",class:"text-[14px] text-color1 font-medium mb-1 inline-block"}," Select Group lesson days",-1),Le=t("option",{value:"",selected:"",hidden:""},"Select days",-1),Ue=t("option",{value:"odd"},"Odd days",-1),Ne=t("option",{value:"even"},"Even days",-1),Te=[Le,Ue,Ne],Fe={key:1,class:"mt-2"},Ee={class:"flex justify-between items-center gap-3 mb-2"},Ie=t("label",{for:"status",class:"text-[14px] text-color1 font-medium mb-1 inline-block"},"Select group status",-1),Ye=t("option",{value:"",hidden:"",selected:""},"Select status",-1),ze=t("option",{value:!0},"Started",-1),Pe=t("option",{value:!1,selected:""},"Not Started",-1),Re=[Ye,ze,Pe],Be={class:"flex justify-between items-center gap-3 mb-2"},Oe=t("label",{for:"room",class:"text-[14px] text-color1 font-medium mb-1 inline-block"},"Select room for group",-1),qe=t("option",{value:"",hidden:"",selected:""},"Select room",-1),He=["value"],We={class:"flex justify-between items-center gap-3 mb-2"},Je=t("label",{for:"course",class:"text-[14px] text-color1 font-medium mb-1 inline-block"},"Select course for group",-1),Ke=t("option",{value:"",hidden:"",selected:""},"Select Course",-1),Qe=["value"],B="large",Xe={__name:"GroupModal",setup(te,{expose:I}){const f=fe(),c=Z(),x=s(!1),g=s(!1),r=s(!1),w=s(!1),G=s("Add New Group"),k=s(null),Y=s("Are you sure to delete?"),y=W(()=>!!(S.value&&m.value&&_.value&&p.value&&!b.value.length)),p=s(""),M=s(""),b=s([]),N=s(""),T=s(""),S=s(""),m=s(""),_=s(""),e=s({name:"",start_date:"",days:"",start_time:"",end_time:"",room:"",status:!1,course:""}),h=n=>n.getTime()<Date.now(),V=n=>{e.value.start_date=ee(n).format("YYYY-MM-DD")},ae=async()=>{if(w.value=!0,m.value&&_.value){const l=m.value.split(":").map(j=>parseInt(j)),C=_.value.split(":").map(j=>parseInt(j));e.value.start_time=l[0]*60+l[1],e.value.end_time=C[0]*60+C[1]}const n={start_date:e.value.start_date,start_time:e.value.start_time,end_time:e.value.end_time,days:e.value.days};b.value=await c.getAvailableRooms(n),w.value=!1},le=()=>{e.value.days=p.value==="odd"},se=()=>{},oe=W(()=>c.loading?"Loading":"Save");pe(r,n=>{n||(e.value={},G.value="Add New Group",p.value="",M.value="",T.value="",b.value=[],N.value="",S.value="",m.value="",_.value="")}),X(async()=>{await f.getCourses()});const ne=async n=>{n._id&&(e.value={...n},G.value="Edit Group"),r.value=!0},ue=n=>{k.value=n,g.value=!0},de=()=>{g.value=!1},re=()=>{r.value=!1},ie=async()=>{var n,l;x.value=!0,(n=e.value)!=null&&n._id?await c.updateGroup({...e.value},(l=e.value)==null?void 0:l._id)?(Q("successfully updated "),r.value=!1,location.reload()):(console.log(c.error,"error"),R(c.error.message)):await c.addGroup({...e.value})?(Q("successfully added "),r.value=!1,location.reload()):R(c.error),x.value=!1},ce=async()=>{x.value=!0;const n=await c.deleteGroup(k.value);x.value=!1,n?ve("Deleted success"):R("Failed!"),g.value=!1,location.reload()};return I({openModal:ne,closeModal:re,openDelModal:ue}),(n,l)=>{const C=E("vee-form"),j=E("el-date-picker"),H=E("el-time-select");return i(),v(P,null,[d(K,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=$=>g.value=$)},{default:o(()=>[d(C,null,{default:o(()=>[t("span",we,[d(D(xe),{type:"mdi",path:D(ye),class:"w-20 h-20 text-red-700 mb-3"},null,8,["path"])]),t("h1",ke,u(Y.value),1),t("div",Se,[d(U,{btn_type:"danger",isLoading:x.value,type:"button",class:"mt-5 text-[18px] px-8",onClick:ce},{default:o(()=>[L(" Delete ")]),_:1},8,["isLoading"]),d(U,{btn_type:"primary",isLoading:!1,type:"button",class:"mt-5 px-8 text-[18px]",onClick:de},{default:o(()=>[L(" Cancel ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),d(K,{modelValue:r.value,"onUpdate:modelValue":l[9]||(l[9]=$=>r.value=$)},{default:o(()=>{var $;return[t("h1",Ve,u(G.value),1),t("div",null,[De,A(t("input",{id:"name",type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>e.value.name=a),required:"",placeholder:"Enter group name",class:"border w-full px-3 py-[6px] text-lg rounded-lg outline-none mb-2"},null,512),[[me,e.value.name]]),t("div",Ce,[$e,d(j,{id:"startDate",modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=a=>S.value=a),type:"date",placeholder:"Pick a date",size:B,"disabled-date":h,onChange:V,style:{width:"100%"}},null,8,["modelValue"])]),Ge,t("div",Me,[d(H,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=a=>m.value=a),"max-time":_.value,size:B,placeholder:"Start time",start:"06:00",step:"00:30",end:"22:00"},null,8,["modelValue","max-time"]),d(H,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=a=>_.value=a),"min-time":m.value,placeholder:"End time",start:"06:00",step:"00:30",end:"22:00",size:B},null,8,["modelValue","min-time"])]),t("div",je,[Ae,A(t("select",{id:"days","onUpdate:modelValue":l[5]||(l[5]=a=>p.value=a),onChange:le,class:"outline-none border px-2 py-2 text-sm rounded-md w-1/2"},Te,544),[[F,p.value]])]),y.value?(i(),O(U,{key:0,onClick:ae,btn_type:"primary",isLoading:w.value,type:"button",class:"mt-2 w-full text-[14px]"},{default:o(()=>[L(" Get rooms ")]),_:1},8,["isLoading"])):q("",!0),($=b.value)!=null&&$.length?(i(),v("div",Fe,[t("div",Ee,[Ie,A(t("select",{id:"status","onUpdate:modelValue":l[6]||(l[6]=a=>e.value.status=a),class:"outline-none border px-2 rounded-md py-2 text-sm"},Re,512),[[F,e.value.status]])]),t("div",Be,[Oe,A(t("select",{id:"room","onUpdate:modelValue":l[7]||(l[7]=a=>e.value.room=a),class:"outline-none border px-2 rounded-md py-2 text-sm"},[qe,(i(!0),v(P,null,J(b.value,(a,z)=>(i(),v("option",{key:z,value:a==null?void 0:a._id},u(a==null?void 0:a.name),9,He))),128))],512),[[F,e.value.room]])]),t("div",We,[Je,A(t("select",{id:"course","onUpdate:modelValue":l[8]||(l[8]=a=>e.value.course=a),onChange:se,class:"outline-none border px-2 rounded-md py-2 text-sm"},[Ke,(i(!0),v(P,null,J(D(f).courses,(a,z)=>(i(),v("option",{key:z,value:a==null?void 0:a._id},u(a==null?void 0:a.name),9,Qe))),128))],544),[[F,e.value.course]])]),d(U,{onClick:ie,btn_type:"primary",isLoading:x.value,type:"button",class:"mt-5 w-full text-[14px]"},{default:o(()=>[L(u(oe.value),1)]),_:1},8,["isLoading"])])):q("",!0)])]}),_:1},8,["modelValue"])],64)}}},Ze={class:"w-full pt-5"},et={class:"w-full"},tt={key:1},at={class:"w-full flex justify-between items-center sm:pr-5 pr-1"},lt={class:"text-[#002842] text-[22px] font-semibold uppercase"},st={class:"w-full overflow-auto mt-5"},ot=t("span",{class:"w-full flex justify-center items-center"},[t("input",{type:"checkbox",class:"w-[18px] h-[18px]"})],-1),nt=["onClick"],ut={class:"w-full flex justify-start items-center"},dt={key:1,class:"w-full text-center text-[20px] text-color1 mt-10 font-medium"},rt={key:2,class:"w-full flex justify-end px-5 items-center mt-3"},ht={__name:"GroupPage",setup(te){const I=_e(),f=Z(),c=y=>ee(y).format("DD/MM/YY"),x=y=>{const p=parseInt(y/60).toString().padStart(2,0),M=(y%60).toString().padStart(2,0);return`${p}:${M}`},g=async()=>{k.value=await f.getGroups(r.value)},r=s({page:1,limit:10}),w=s(""),G=s([{title:"checkbox",value:"check"},{title:"ID",value:"_id"},{title:"Group name",value:"name"},{title:"Start Date",value:"start_date"},{title:"Finish Date",value:"end_date"},{title:"Days",value:"days"},{title:"Start Time",value:"start_time"},{title:"Finish Time",value:"end_time"},{title:"Status",value:"status"},{title:"Room info",value:"room"},{title:"Course info",value:"course"},{title:"Action",value:"action"}]),k=s(0);X(async()=>{k.value=await f.getGroups(r.value)});const Y=y=>{I.push({path:`/groups/${y}`})};return(y,p)=>{var b,N,T,S,m,_;const M=E("vue-awesome-paginate");return i(),v("div",Ze,[t("div",et,[d(Xe,{ref_key:"group_modal",ref:w},null,512)]),D(f).loading?(i(),O(be,{key:0})):(i(),v("div",tt,[t("div",at,[t("h1",lt," Groups ("+u(k.value)+") ",1),d(U,{type:"button",btn_type:"primary",isLoading:!1,onClick:(b=w.value)==null?void 0:b.openModal,class:"px-10"},{default:o(()=>[L("Add group")]),_:1},8,["onClick"])]),t("div",st,[(T=(N=D(f))==null?void 0:N.groups)!=null&&T.length?(i(),O(he,{key:0,header:G.value,data:(S=D(f))==null?void 0:S.groups},{body_check:o(()=>[ot]),body_name:o(({item:e})=>[t("span",{onClick:h=>Y(e._id),class:"w-full"},u(`${e.name}`),9,nt)]),body_start_date:o(({item:e})=>[t("span",null,u(c(e==null?void 0:e.start_date)),1)]),body_end_date:o(({item:e})=>[t("span",null,u(c(e==null?void 0:e.end_date)),1)]),body_days:o(({item:e})=>[t("span",null,u(e!=null&&e.days?"Mon/Wed/Fri":"Tue/Thu/Sat"),1)]),body_start_time:o(({item:e})=>[t("span",null,u(x(e==null?void 0:e.start_time)),1)]),body_end_time:o(({item:e})=>[t("span",null,u(x(e==null?void 0:e.end_time)),1)]),body_status:o(({item:e})=>[t("span",null,u(e!=null&&e.status?"Started":"Finished"),1)]),body_room:o(({item:e})=>{var h,V;return[t("span",null,u((h=e==null?void 0:e.room)!=null&&h.name?`${(V=e==null?void 0:e.room)==null?void 0:V.name}`:"No data"),1)]}),body_course:o(({item:e})=>{var h,V;return[t("span",null,u((h=e==null?void 0:e.course)!=null&&h.name?`${(V=e==null?void 0:e.course)==null?void 0:V.name}`:"No data"),1)]}),body_action:o(({item:e})=>[t("span",ut,[d(ge,{item:e,item_action:w.value},null,8,["item","item_action"])])]),_:1},8,["header","data"])):(i(),v("h1",dt," No data ")),(_=(m=D(f))==null?void 0:m.groups)!=null&&_.length?(i(),v("div",rt,[d(M,{"total-items":k.value,"items-per-page":r.value.limit,"max-pages-shown":2,modelValue:r.value.page,"onUpdate:modelValue":p[0]||(p[0]=e=>r.value.page=e),"on-click":g},null,8,["total-items","items-per-page","modelValue"])])):q("",!0)])]))])}}};export{ht as default};
