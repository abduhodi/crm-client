import{r as i,c as F,a as S,o as d,i as $,w as h,d as f,f as u,b as _,F as B,e as N,t as x,g as U,s as j,h as q,y as O,A as P,u as R}from"./index-c34ed4f6.js";import{_ as z}from"./accordion-a71e1a03.js";import{u as C}from"./group-94194bea.js";import{L as H}from"./Loader-93f7da13.js";import{_ as D,d as I}from"./VButton-ff6e3586.js";import{A as J}from"./app-modal-afe5a922.js";import{_ as K}from"./VInput-5d59eade.js";import{f as Q}from"./moment-36213c16.js";import"./apiClient-172dff35.js";import"./moment-a9aaa855.js";const W=f("hr",null,null,-1),X={__name:"StudentAttendance",setup(E,{expose:g}){const b=C(),c=i({title:""}),r=i(!1),p=F(()=>({title:"required|min:5"})),l=i([]),o=i(!1),y=t=>{var a,e;l.value=t,c.value.title=(e=(a=l.value[0])==null?void 0:a.lesson)==null?void 0:e.title,o.value=!0},m=async t=>{var e,v;r.value=!0;const a=[];l.value.forEach(s=>{a.push({_id:s==null?void 0:s._id,participated:s==null?void 0:s.participated})}),console.log(a),await Promise.all([b.setLessonTitle((v=(e=l.value[0])==null?void 0:e.lesson)==null?void 0:v._id,t),b.updateLessonAttendance({data:a})]),r.value=!1};return g({openModal:y}),(t,a)=>{const e=S("el-switch"),v=S("vee-form");return d(),$(J,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s)},{default:h(()=>[f("div",null,[f("div",null,[u(v,{"validation-schema":p.value,onSubmit:m,"initial-values":c.value},{default:h(()=>{var s,w,L,V;return[u(K,{name:"title",label:"Enter lesson's theme",placeholder:"Lesson theme",style:{"margin-bottom":"20px"},disabled:(w=(s=l.value[0])==null?void 0:s.lesson)==null?void 0:w.pass},null,8,["disabled"]),W,(d(!0),_(B,null,N(l.value,(n,G)=>{var k,M,A;return d(),_("div",{key:G,class:"flex justify-between items-center w-full mt-2 border-b pb-2"},[f("span",null,x((k=n==null?void 0:n.student)==null?void 0:k.first_name)+" "+x((M=n==null?void 0:n.student)==null?void 0:M.last_name),1),u(e,{modelValue:n.participated,"onUpdate:modelValue":T=>n.participated=T,style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#b4b4b4"},"active-value":!0,"inactive-value":!1,disabled:(A=n.lesson)==null?void 0:A.pass},null,8,["modelValue","onUpdate:modelValue","disabled"])])}),128)),u(D,{btn_type:"info",style:{padding:"5px 30px","margin-top":"20px"},type:"submit",isLoading:r.value,disabled:(V=(L=l.value[0])==null?void 0:L.lesson)==null?void 0:V.pass},{default:h(()=>[U("save")]),_:1},8,["isLoading","disabled"])]}),_:1},8,["validation-schema","initial-values"])])])]),_:1},8,["modelValue"])}}},Y={class:"mt-5"},Z={key:1,class:"md:h-fit h-screen"},ee={class:"flex items-center gap-10 mb-5"},ae=["value","disabled"],pe={__name:"SingleGroup",setup(E){const g=C(),b=j(),c=i(!1),r=i(!1),p=i([]),l=i(),o=i(""),y=async()=>{if(!o.value){I("lesson date is not selected");return}r.value=!0;const m=await g.getOneLessonAttendance(b.params.id,{date:o.value});l.value.openModal(m),r.value=!1};return q(async()=>{var t,a;c.value=!0;const m=b.params.id;p.value=await g.getGroupStudents(m),o.value=(a=(t=p.value[0])==null?void 0:t.attendance[0])==null?void 0:a.date,console.log(o.value),c.value=!1}),(m,t)=>{var a;return d(),_("div",Y,[c.value?(d(),$(H,{key:0})):(d(),_("div",Z,[u(X,{ref_key:"attendanceModal",ref:l},null,512),f("div",ee,[u(D,{btn_type:"primary",isLoading:r.value,onClick:y,class:"w-fit"},{default:h(()=>[U("Mark Attendance")]),_:1},8,["isLoading"]),O(f("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),class:"lg:px-5 py-2 rounded-md text-lg outline-none"},[(d(!0),_(B,null,N((a=p.value[0])==null?void 0:a.attendance,(e,v)=>(d(),_("option",{value:e==null?void 0:e.date,key:v,disabled:e==null?void 0:e.pass,class:"text-xs px-5"},x(R(Q)(e==null?void 0:e.date)),9,ae))),128))],512),[[P,o.value]])]),u(z,{data:p.value},null,8,["data"])]))])}}};export{pe as default};
