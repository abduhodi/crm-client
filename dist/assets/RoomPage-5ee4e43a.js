import{A as B}from"./app-modal-ef920211.js";import{_ as M,s as S,d as j,w as U}from"./VButton-d6e73414.js";import{_ as I}from"./VInput-1c3b4578.js";import{v as O,r as c,c as z,l as H,a as q,o as p,b as x,f as l,w as i,d as r,u as m,t as w,g as L,F as P,m as T,h as G,i as E,q as J}from"./index-5fceaf5e.js";import{a as v}from"./apiClient-4e000a57.js";import{S as K,j as Q}from"./mdi-32fed39f.js";import{L as W}from"./Loader-35472409.js";import{_ as X,a as Y}from"./VAction-11eb2faf.js";const y={getRooms(t){const o=`rooms/all/q?page=${t==null?void 0:t.page}&limit=${t==null?void 0:t.limit}`;return v.get(o)},getRoomById(t){const o=`rooms/${t}`;return v.get(o)},addRoom(t){const o="rooms/create-room";return v.post(o,t)},updateRoom(t,o){const e=`rooms/update/${o}`;return v.put(e,t)},deleteRoom(t){const o=`rooms/delete/${t}`;return v.delete(o)}},F=O("admin-room",{state:()=>({rooms:null,loading:!1,error:null,status:null,room:null}),actions:{async addRoom(t){var o;try{this.loading=!0;const e=await y.addRoom(t);return this.room=e.room,console.log(e),!0}catch(e){return this.error=(o=e==null?void 0:e.response)==null?void 0:o.data,console.log(e),!1}finally{this.loading=!1}},async getRooms(t){var o;try{this.loading=!0;const e=await y.getRooms(t);return this.rooms=e.rooms,e==null?void 0:e.count}catch(e){return this.error=(o=e==null?void 0:e.response)==null?void 0:o.data,console.log(e),!1}finally{this.loading=!1}},async updateRoom(t,o){var e;try{this.loading=!0;const a=await y.updateRoom(t,o);return this.room=a.room,console.log(a),!0}catch(a){return this.error=(e=a==null?void 0:a.response)==null?void 0:e.data,console.log(a),!1}finally{this.loading=!1}},async deleteRoom(t){var o;try{this.loading=!0;const e=await y.deleteRoom(t);return this.room=e.room,console.log(e),!0}catch(e){return this.error=(o=e==null?void 0:e.response)==null?void 0:o.data,console.log(e),!1}finally{this.loading=!1}},async getRoomById(t){var o;try{this.loading=!0;const e=await y.getRoomById(t);return this.room=e.room,console.log(e),!0}catch(e){return this.error=(o=e==null?void 0:e.response)==null?void 0:o.data,console.log(e),!1}finally{this.loading=!1}}}}),Z={class:"w-full flex justify-center items-center"},ee={class:"text-[24px] font-bold w-full text-center mb-[20px] text-color1"},oe={class:"flex justify-center items-center w-full gap-3"},te={class:"text-[24px] font-bold w-full text-center mb-[20px] text-color1"},se={__name:"RoomModal",setup(t,{expose:o}){const e=F(),a=c(!1),n=c(!1),f=c("Add New Room"),R=c(null),_=c("Are you sure to delete?"),D=z(()=>e.loading?"Loading":"Save"),u=c({name:"",size:0});H(n,s=>{s||(u.value={},f.value="Add New Room")});const b=s=>{s._id&&(u.value={...s},f.value="Edit Room"),n.value=!0},N=s=>{R.value=s,a.value=!0},k=()=>{a.value=!1},$=()=>{n.value=!1},C=z(()=>({name:"required|min:2|max:30",size:"required"})),V=async s=>{var d,g;(d=u.value)!=null&&d._id?await e.updateRoom({...s},(g=u.value)==null?void 0:g._id)?(S("successfully updated "),n.value=!1,location.reload()):(console.log(e.error,"error"),j(e.error.message)):await e.addRoom({...s})?(S("successfully added "),n.value=!1,location.reload()):j(e.error)},A=async()=>{await e.deleteRoom(R.value)?U("Deleted success"):j("Failed!"),a.value=!1,location.reload()};return o({openModal:b,closeModal:$,openDelModal:N}),(s,d)=>{const g=q("vee-form");return p(),x(P,null,[l(B,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=h=>a.value=h)},{default:i(()=>[l(g,null,{default:i(()=>[r("span",Z,[l(m(K),{type:"mdi",path:m(Q),class:"w-20 h-20 text-red-700 mb-3"},null,8,["path"])]),r("h1",ee,w(_.value),1),r("div",oe,[l(M,{btn_type:"danger",isLoading:m(e).loading,type:"button",class:"mt-5 text-[18px] px-8",onClick:A},{default:i(()=>[L(" Delete ")]),_:1},8,["isLoading"]),l(M,{btn_type:"primary",isLoading:!1,type:"button",class:"mt-5 px-8 text-[18px]",onClick:k},{default:i(()=>[L(" Cancel ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=h=>n.value=h)},{default:i(()=>[r("h1",te,w(f.value),1),l(g,{"validation-schema":C.value,"initial-values":u.value,onSubmit:V},{default:i(()=>[l(I,{type:"text",name:"name",label:"Room Name",placeholder:"Enter room name"}),l(I,{type:"number",name:"size",label:"Room volume",placeholder:"Enter room volume"}),l(M,{btn_type:"primary",isLoading:m(e).loading,type:"submit",class:"mt-5 w-full text-[18px]"},{default:i(()=>[L(w(D.value),1)]),_:1},8,["isLoading"])]),_:1},8,["validation-schema","initial-values"])]),_:1},8,["modelValue"])],64)}}},ae={class:"w-full pt-5"},le={class:"w-full"},ne={key:1},re={class:"w-full flex justify-between items-center sm:pr-5 pr-1"},ie={class:"text-[#002842] text-[22px] font-semibold uppercase"},ce={class:"w-full mt-5 overflow-auto"},ue=r("span",{class:"w-full flex justify-center items-center"},[r("input",{type:"checkbox",class:"w-[18px] h-[18px]"})],-1),de=["onClick"],me={class:"w-full flex justify-start items-center"},fe={key:1,class:"w-full text-center text-[20px] text-color1 mt-10 font-medium"},pe={key:2,class:"w-full flex justify-end px-5 items-center mt-3"},be={__name:"RoomPage",setup(t){const o=T(),e=F(),a=async()=>{_.value=await e.getRooms(n.value)},n=c({page:1,limit:10}),f=c(""),R=c([{title:"checkbox",value:"check"},{title:"ID",value:"_id"},{title:"Room name",value:"name"},{title:"Room size",value:"size"},{title:"Action",value:"action"}]),_=c(0);G(async()=>{_.value=await e.getRooms(n.value)});const D=u=>{o.push({path:`/rooms/${u}`})};return(u,b)=>{var k,$,C,V,A;const N=q("vue-awesome-paginate");return p(),x("div",ae,[r("div",le,[l(se,{ref_key:"room_modal",ref:f},null,512)]),m(e).loading?(p(),E(W,{key:0})):(p(),x("div",ne,[r("div",re,[r("h1",ie," Rooms ("+w(_.value)+") ",1),l(M,{type:"button",btn_type:"primary",isLoading:!1,onClick:f.value.openModal,class:"px-10"},{default:i(()=>[L("Add room")]),_:1},8,["onClick"])]),r("div",ce,[($=(k=m(e))==null?void 0:k.rooms)!=null&&$.length?(p(),E(X,{key:0,header:R.value,data:(C=m(e))==null?void 0:C.rooms},{body_check:i(()=>[ue]),body_name:i(({item:s})=>[r("span",{onClick:d=>D(s._id),class:"w-full"},w(`${s.name}`),9,de)]),body_action:i(({item:s})=>[r("span",me,[l(Y,{item:s,item_action:f.value},null,8,["item","item_action"])])]),_:1},8,["header","data"])):(p(),x("h1",fe," No data ")),(A=(V=m(e))==null?void 0:V.rooms)!=null&&A.length?(p(),x("div",pe,[l(N,{"total-items":_.value,"items-per-page":n.value.limit,"max-pages-shown":2,modelValue:n.value.page,"onUpdate:modelValue":b[0]||(b[0]=s=>n.value.page=s),"on-click":a},null,8,["total-items","items-per-page","modelValue"])])):J("",!0)])]))])}}};export{be as default};
